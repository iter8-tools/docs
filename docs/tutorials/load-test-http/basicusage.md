---
template: main.html
---

# Benchmark and Validate HTTP services

The `load-test-http` experiment generates requests for HTTP services, collects latency and error-related metrics, and validates service-level objectives (SLOs).

<p align='center'>
  <img alt-text="load-test-http" src="../images/http-overview.png" width="90%" />
</p>

***

--8<-- "docs/tutorials/load-test-http/usecases.md"

***

???+ warning "Before you begin"
    Run the [httpbin](https://httpbin.org) sample service from a separate terminal.
    ```shell
    docker run -p 80:80 kennethreitz/httpbin
    ```
    You can also use [Podman](https://podman.io) or other alternatives to Docker in the above command.

***

## Basic example
Benchmark an HTTP service with a GET endpoint by specifying the `url`.

```shell
iter8 launch -c load-test-http --set url=http://127.0.0.1/get
```

***

## Metrics and SLOs
The following metrics are collected by default by this experiment:

- `http/request-count`: total number of requests sent
- `http/error-count`: number of error responses
- `http/error-rate`: fraction of error responses
- `http/latency-mean`: mean of observed latency values
- `http/latency-stddev`: standard deviation of observed latency values
- `http/latency-min`: min of observed latency values
- `http/latency-max`: max of observed latency values
- `http/latency-pX`: X^th^ percentile latency, for X in `[50.0, 75.0, 90.0, 95.0, 99.0, 99.9]`

Latency metrics have `msec` units. Any latency percentile that is specified as part of SLOs is also collected.

***

Launch the following experiment. The `--noDownload` flag reuses the Iter8 experiment `charts` folder downloaded during the previous `iter8 launch` command invocation.

```shell
iter8 launch -c load-test-http --noDownload \
--set url=http://127.0.0.1/get \
--set SLOs.http/error-rate=0 \
--set SLOs.http/latency-mean=50 \
--set SLOs.http/latency-p90=100 \
--set SLOs.http/latency-p'97\.5'=200
```

In the experiment above, the following SLOs are validated.

- error rate is 0
- mean latency is under 50 msec
- 90th percentile latency is under 100 msec
- 97.5th percentile latency is under 200 msec

***

## View experiment report

--8<-- "docs/tutorials/load-test-http/expreport.md"

***

## Assertions

--8<-- "docs/tutorials/load-test-http/assert.md"


***

## Load profile
Control the characteristics of the load generated by the `load-test-http` experiment by setting the number of queries (`numQueries`), the number of queries sent per second (`qps`), and the number of parallel connections used to send queries  (`connections`).

```shell
iter8 launch -c load-test-http --noDownload \
--set url=http://127.0.0.1/get \
--set numQueries=200 \
--set qps=10 \
--set connections=5
```

You can also set the `duration` of the load generation period. Refer to the [chart's default values](../../user-guide/topics/default-values.md) for details.


## Payload
Send any type of content as payload and specify the HTTP Content Type header. These options switch the HTTP method to POST.

=== "String"
    Specify payload as a string. By default, its content type is set to `application/octet-stream`.
    ```shell
    iter8 launch -c load-test-http --noDownload \
    --set url=http://127.0.0.1/post \
    --set payloadStr="abc123"
    ```

=== "String with contentType"
    ```shell
    iter8 launch -c load-test-http --noDownload \
    --set url=http://127.0.0.1/post \
    --set payloadStr="abc123" \
    --set contentType="text/plain"
    ```

=== "JSON from URL"
    Fetch JSON content from a URL. Use this JSON as payload. Set content type to `application/json`.
    ```shell
    iter8 launch -c load-test-http --noDownload \
    --set url=http://127.0.0.1/post \
    --set payloadURL=https://data.police.uk/api/crimes-street-dates \
    --set contentType="application/json"
    ```

=== "Image from URL"
    Fetch jpeg image from a URL. Use this image as payload. Set content type to `image/jpeg`.
    ```shell
    iter8 launch -c load-test-http --noDownload \
    --set url=http://127.0.0.1/post \
    --set payloadURL=https://cdn.pixabay.com/photo/2021/09/08/17/58/poppy-6607526_1280.jpg \
    --set contentType="image/jpeg"
    ```
