---
template: main.html
tags:
- load testing
- benchmarking
- SLOs
- HTTP
---

# Benchmark and Validate HTTP Services

Iter8's `load-test-http` experiment generates call requests for HTTP services, collects latency and error-related metrics, and validates service-level objectives (SLOs).

<p align='center'>
  <img alt-text="load-test-http" src="../images/http-overview.png" width="90%" />
</p>

***

--8<-- "docs/tutorials/load-test-http/usecases.md"

***

???+ warning "Before you begin"
    Run the [httpbin](https://httpbin.org) sample service from a separate terminal.
    ```shell
    docker run -p 80:80 kennethreitz/httpbin
    ```
    You can also use [Podman](https://podman.io) or other alternatives to Docker in the above command.

***

## Basic example
Benchmark an HTTP service with a GET endpoint by specifying the `url`.

```shell
iter8 launch -c load-test-http --set url=http://127.0.0.1/get
```


## Metrics and SLOs
The following metrics are collected by default by this experiment:

- `http/request-count`: total number of requests sent
- `http/error-count`: number of error responses
- `http/error-rate`: fraction of error responses
- `http/latency-mean`: mean of observed latency values
- `http/latency-stddev`: standard deviation of observed latency values
- `http/latency-min`: min of observed latency values
- `http/latency-max`: max of observed latency values
- `http/latency-pX`: X^th^ percentile latency, for X in `[50.0, 75.0, 90.0, 95.0, 99.0, 99.9]`

Latency metrics have `msec` units. Any latency percentiles that are specified as part of SLOs are also collected.

***

```shell
--set SLOs.http/error-rate=0 \
--set SLOs.http/latency-mean=50 \
--set SLOs.http/latency-p90=100 \
--set SLOs.http/latency-p'97\.5'=200
```

In the above setting, the following SLOs will be validated.

- error rate is 0
- mean latency is under 50 msec
- 90th percentile latency is under 100 msec
- 97.5th percentile latency is under 200 msec

***

### Report

Refer to [your first experiment](../../getting-started/your-first-experiment.md#3-view-experiment-report) for examples of HTML and text `iter8 report`.

***

### Assert
The `iter8 assert` subcommand asserts if experiment result satisfies the specified conditions. If assert conditions are satisfied, it exits with code `0`; else, it exits with code `1`. Assertions are especially useful inside CI/CD/GitOps pipelines.

Assert that the experiment completed without failures, and all SLOs are satisfied.
```shell
iter8 assert -c completed -c nofailure -c slos
```

???+ note "Sample output from assert"
    ```shell
    INFO[2021-11-10 09:33:12] experiment completed
    INFO[2021-11-10 09:33:12] experiment has no failure                    
    INFO[2021-11-10 09:33:12] SLOs are satisfied                           
    INFO[2021-11-10 09:33:12] all conditions were satisfied
    ```

***

## Load profile
Control the characteristics of the load generated by the `load-test-http` experiment by setting the number of queries (`numQueries`), the number of queries sent per second (`qps`), and the number of parallel connections used to send queries  (`connections`).

```shell
--set numQueries=200 \
--set qps=10 \
--set connections=5
```

You can also set the `duration` of the load generation period. Refer to the [chart's `values.yaml` file](../../user-guide/topics/chart-docs.md) for details.


## Payload
Send any type of content as payload and specify the HTTP Content Type header. These options switch the HTTP method to POST.

=== "String"
    Specify payload as a string. By default, its content type is set to `application/octet-stream`.
    ```shell
    --set payloadStr="abc123"
    ```

=== "String with contentType"
    ```shell
    --set payloadStr="abc123" \
    --set contentType="text/plain"
    ```

=== "JSON from URL"
    Fetch JSON content from a URL. Use this JSON as payload. Set content type to `application/json`.
    ```shell
    --set payloadURL=https://data.police.uk/api/crimes-street-dates \
    --set contentType="application/json"
    ```

=== "Image from URL"
    Fetch jpeg image from a URL. Use this image as payload. Set content type to `image/jpeg`.
    ```shell
    --set payloadURL=https://cdn.pixabay.com/photo/2021/09/08/17/58/poppy-6607526_1280.jpg \
    --set contentType="image/jpeg"
    ```
